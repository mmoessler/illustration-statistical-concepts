<!doctype html>
<html lang="eng">
  <head>

    <title>Linear Regression - OLS - Heteroskedasticity</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/10.0.0/css/bootstrap-slider.min.css">

    <!-- my style sheet -->
    <link rel="stylesheet" href="../assets/mystyle.css">

    <!-- logo -->
    <div class="logo-cl header-01-cl" style="text-align:center; padding-top: 20px; padding-bottom: 20px;" background-color="#eeeeee;">
      <img src="../assets/RZ_UniHohenheim_Logo_1C_Weiss_EN.svg" height="250px"/>
    </div>

  </head>
  <body>

    <div class="container mt-5">
      <div class="row">

        <div class="jumbotron top-jumb-cl" style="margin-top: 50px; padding: 25px 50px 25px 50px;">
            
          <p style='font-size: 28pt;'>Linear Regression Model and the OLS Estimator</p>
            <p style='font-size: 18pt; margin-bottom: 0;'>Effect of Heteroskedasticity</p> 
      
          </div>

      </div>
    </div>

    <div class="container mt-5">
      <div class="row">

        <div class="jumbotron" style="padding: 25px 50px 25px 50px">

          <p style="font-size: 18pt">Topic of the module</p>

          <div style="margin-left: 10pt;">
          
            <p>Understand the effect of heteroskedasticity on the sampling distribution of the OLS estimator.</p>
          
          </div>          

          <hr>

          <p style="font-size: 18pt">Data generating process (DGP)</p>
        
          <div style="margin-left: 10pt;">
                    
            <p>Consider \(n\) observations are generated from the simple regression model,</p>

            $$
            \begin{align}
            Y_i = \beta_{0} + \beta_{1} X_{i} + u_{i},
            \end{align}
            $$

            <p>where \(\beta_{0}=1\) is the intercept and \(\beta_{1}\) is the slope parameter.</p>

            <p>Furthermore, suppose \(X_{i}\) and \(u_{i}\) are independently normally distributed, i.e.,</p>

            $$
            \begin{align}
            X_{i} \sim N\left(0, \sigma_{X}^{2}\right), \;\;\;\;\; u_{i} \sim N\left(0, \sigma_{ui}^{2}\right),
            \end{align}
            $$

            <p>where \(\sigma_{X}^{2}\) and \(\sigma_{ui}^{2}\) is the variance of \(X_{i}\) and \(u_{i}\).</p>

          </div>

          <hr>

          <p style="text-decoration: underline;">Conditions for and Effects of heteroskedasticity</p>

          <div style="margin-left: 10pt;">
          
            <p>Heteroskedasticity occurs when \(\sigma_{ui}^{2}\) is not constant but a function of \(X_{i}\), e.g.,</p>

            $$
            \begin{align}
            \sigma_{ui}^{2} = \text{exp}\left(\gamma_{0} + \gamma_{1} X_{i}\right),
            \end{align}
            $$

            <p>which is also known as multiplicative heteroskedasticity where \(\gamma_{0}\) and \(\gamma_{1}\) are parameters which determine the shape of the heteroskedasticity.</p>

            <p>Thus, for positive/negative values of \(\gamma_{1}\) the variance of \(u_{i}\) is positively/negatively related with the value of \(X_{i}\).</p>

            <p>Heteroskedasticity effects the standard error of the OLS estimator \(\widehat{\beta}_{1}\) and thus the construction of the standardized OLS estimator \(z_{\widehat{\beta}_{1}}\).</p>

            <button type="button" class="coll-button-cl"> <span style="font-size: 14pt;">More Details</span> </button>
            <div class="coll-content-cl">

              <p style="margin-top: 10px;">
                For the construction of the standardized OLS estimator \(z_{\widehat{\beta}_{1}}\), the variance of \(\widehat{\beta}_{1}\), i.e., \(\sigma_{\widehat{\beta}_{1}}^{2}\), has to be estimated.
              </p>
              
              <p>The variance of \(\widehat{\beta}_1\), i.e., \(\sigma_{\widehat{\beta}_{1}}^{2}\), can be robustly estimated by,</p>
              
              $$
              \begin{align}
              \widehat{\sigma}_{\widehat{\beta}_{1}}^{2} = \frac{1}{n} \times \frac{\frac{1}{n-2}\sum_{i=1}^{n}\left(X_{i} - \overline{X}\right)^{2}\widehat{u}_{i}^{2}}{\left[\frac{1}{n}\sum_{i=1}^{n}\left(X_{i} - \overline{X}\right)^{2}\right]^{2}},
              \end{align}
              $$

              <p>where \(\widehat{u}_{i}\) are the residuals of the estimate regression line.</p>

              <p>Note, the estimator for \(\sigma_{\widehat{\beta}_{1}}^{2}\) above is robust w.r.t. to heteroskedasticity, i.e., it does not rely on the assumption of homoskedasticity.</p>

              <p>Instead, some statistic software report estimates \(\sigma_{\widehat{\beta}_{1}}^{2}\), based on the assumption of homoskedasticity.</p>
              
              <p>The so called homoskedasticity-only estimator of \(\sigma_{\widehat{\beta}_{1}}^{2}\), is given by,</p>

              $$
              \begin{align}
              \widetilde{\sigma}_{\widehat{\beta}_{1}}^{2} = \frac{\frac{1}{n-2}\sum_{i=1}^{n}\widehat{u}_{i}^{2}}{\sum_{i=1}^{n}\left(X_{i} - \overline{X}\right)^{2}}.
              \end{align}
              $$

            </div>

          </div>

        </div>

      </div>
    </div>

    <div class="container mt-5">
      <div class="row">

        <div class="jumbotron outer-jumb-cl" style="padding: 25px 50px 25px 50px">
            
            <p style="font-size: 18pt">Illustration</p>

            <div style="margin-left: 10pt;">
            
              <p>Change the parameters and see the effect on the properties of the OLS estimator \(\widehat{\beta}_{1}\) as estimator for \(\beta_{1}\).</p>
      
            </div>
            
            <div class="container mt-5" style="margin-top: 50px;">
              <div class="row">

                <div class="col-sm-3" style="margin-top: 90px;">
                  <div class="jumbotron inner-jumb-cl" style="padding: 25px 50px 25px 50px">

                    <p style="font-size: 14pt; text-align: center;">Parameters</p>
                    
                    <div style='margin-top: 50px;'>

                      <hr>

                      <p style="font-size: 12pt; text-align: center;">Sample Size \(n=100\)</p>

                      <p style="font-size: 12pt; text-align: center;">Variance of \(X_{i}\), \(\sigma_{X}^{2} = 5\)</p>

                      <hr>

                      <p style="font-size: 12pt; text-align: center;">Variance of \(u_{i}\)</p><p style="font-size: 12pt; text-align: center" class="slider-value-cl" id="slider-value-1-id"></p>
                      <input class="slider-cl" id="slider-1-id" type="text" data-slider-min="0" data-slider-max="2" data-slider-step="1" data-slider-value="0"/>
                      <div style="font-size: 12pt; text-align: center;">
                        <button class="animateButtonCl" onclick="animateButtonClick(slider = 1)">Animate \(\\\gamma_{0}\)</button>
                      </div>                      
                  
                      <hr>

                      <p style="font-size: 12pt; text-align: center;">Heteroskedasticity</p><p style="font-size: 12pt; text-align: center" class="slider-value-cl" id="slider-value-2-id"></p>
                      <input class="slider-cl" id="slider-2-id" type="text" data-slider-min="0" data-slider-max="2" data-slider-step="1" data-slider-value="0"/>
                      <div style="font-size: 12pt; text-align: center;">
                        <button class="animateButtonCl" onclick="animateButtonClick(slider = 2)">Animate \(\\\gamma_{1}\)</button>
                      </div>

                    </div>

                  </div>
                </div>
                
                <div class="col-sm-9">
                  <div class="jumbotron inner-jumb-cl" style="padding: 15px 50px 25px 50px">
            
                    <div class="tab" style="text-align: center;">
                      <button class="tab-link-l1-cl" onclick="openSpecificTab('tab-content-l1-n1-id', 'tab-link-l1-n1-id', 'white')" id="tab-link-l1-n1-id">Realizations</button>
                      <button class="tab-link-l1-cl" onclick="openSpecificTab('tab-content-l1-n2-id', 'tab-link-l1-n2-id', 'white')" id="tab-link-l1-n2-id">Residuals</button>
                      <button class="tab-link-l1-cl" onclick="openSpecificTab('tab-content-l1-n3-id', 'tab-link-l1-n3-id', 'white')" id="tab-link-l1-n3-id">Estimates</button>
                      <button class="tab-link-l1-cl" onclick="openSpecificTab('tab-content-l1-n4-id', 'tab-link-l1-n4-id', 'white')" id="tab-link-l1-n4-id">Standardized Est.</button>
                    </div>

                    <br>

                    <div id="tab-content-l1-n1-id" class="tab-content-l1-cl">

                      <table style="width:100%; margin-bottom: 10px;">
                        <tr>
                          <td style="width: 10%"></td>
                          <td style="width: 80%; font-size: 14pt; text-align: left;">Scatter plot (realizations)</td>
                          <td style="width: 10%; font-size: 14pt; text-align: right;">
                            <button class="explainButtonCl" onclick="explainButtonClick()">Explain</button>
                          </td>
                        </tr>
                      </table>

                      <div style="text-align: center;">
                        <img src="./figures/figure_01_1_1.svg" alt="" class="figure-cl" id="figure-1-id" style="max-width: 75%;">
                      </div> 

                      <p class="audio-show-text-cl" id="audio-show-text-figure-1-id" style="font-size: 10pt; color: red; font-style: italic; text-align: center; display: none;"></p>

                      <p>The red fitted regression line is based on the regression of,</p>

                      $$
                      \begin{align}
                      Y_{i} \;\;\;\;\; \text{on} \;\;\;\;\; X_{i}.
                      \end{align}
                      $$

                      <p>The scatter plots and the fitted regression lines represent the result for only one simulation. The shaded areas illustrate the range of all fitted regression lines across all simulation outcomes.</p>

                    </div>

                    <div id="tab-content-l1-n2-id" class="tab-content-l1-cl">

                      <table style="width:100%; margin-bottom: 10px;">
                        <tr>
                          <td style="width: 10%"></td>
                          <td style="width: 80%; font-size: 14pt; text-align: left;">Scatter plot (fitted residuals)</td>
                          <td style="width: 10%; font-size: 14pt; text-align: right;">
                            <button class="explainButtonCl" onclick="explainButtonClick()">Explain</button>
                          </td>
                        </tr>
                      </table>

                      <div style="text-align: center;">
                        <img src="./figures/figure_02_1_1.svg" alt="" class="figure-cl" id="figure-2-id" style="max-width: 75%;">
                      </div>

                      <p class="audio-show-text-cl" id="audio-show-text-figure-2-id" style="font-size: 10pt; color: red; font-style: italic; text-align: center; display: none;"></p>

                      <p>The fitted unobserved residuals are constructed as,</p>

                      $$
                      \begin{align}
                      \widehat{u}_{i} = Y_{i} - \widehat{\beta}_{1} X_{i},
                      \end{align}
                      $$
            
                      <p>for only one simulation where \(\widehat{\beta}_{1}\) is the respective OLS estimate.</p>
            
                    </div>

                    <div id="tab-content-l1-n3-id" class="tab-content-l1-cl">

                      <table style="width:100%; margin-bottom: 10px;">
                        <tr>
                          <td style="width: 10%"></td>
                          <td style="width: 80%; font-size: 14pt; text-align: left;">Histogram of the OLS estimates \(\widehat{\beta}_{1}\)</td>
                          <td style="width: 10%; font-size: 14pt; text-align: right;">
                            <button class="explainButtonCl" onclick="explainButtonClick()">Explain</button>
                          </td>
                        </tr>
                      </table>

                      <div style="text-align: center;">
                        <img src="./figures/figure_03_1_1.svg" alt="" class="figure-cl" id="figure-3-id" style="max-width: 75%;">
                      </div>

                      <p class="audio-show-text-cl" id="audio-show-text-figure-3-id" style="font-size: 10pt; color: red; font-style: italic; text-align: center;"></p>

                      <span style="font-size: 16pt; text-decoration: underline;">Consistency</span><span style="font-size: 16pt; text-decoration: none; display: none;">:</span>

                      <p>As the sample size \(N\) grows the OLS estimator \(\widehat{\beta}_{1}\) gets closer to \(\beta\), i.e.,</p>

                      $$
                      \begin{align}
                      \widehat{\beta}_{1} \overset{p}{\to} \beta.
                      \end{align}
                      $$

                    </div>

                    <div id="tab-content-l1-n4-id" class="tab-content-l1-cl">

                      <table style="width:100%; margin-bottom: 10px;">
                        <tr>
                          <td style="width: 10%"></td>
                          <td style="width: 80%; font-size: 14pt; text-align: left;">Histogram of the standardized OLS estimates \(z_{\widehat{\beta}_{1}}\)</td>
                          <td style="width: 10%; font-size: 14pt; text-align: right;">
                            <button class="explainButtonCl" onclick="explainButtonClick()">Explain</button>
                          </td>
                        </tr>
                      </table>

                      <div style="text-align: center;">
                        <img src="./figures/figure_04_1_1.svg" alt="" class="figure-cl" id="figure-4-id" style="max-width: 75%;">
                      </div>

                      <p class="audio-show-text-cl" id="audio-show-text-figure-4-id" style="font-size: 10pt; color: red; font-style: italic; text-align: center; display: none;"></p>

                      <span style="font-size: 16pt; text-decoration: underline;">Asymptotic Normality</span><span style="font-size: 16pt; text-decoration: none;">:</span>

                      <p>In the case of heteroskedasticity,</p>

                      $$
                      \begin{align}
                      z_{\overline{Y}} &= \frac{\overline{Y} - \beta}{\widehat{\sigma}_{\widehat{\beta}_{1}}},
                      \end{align}
                      $$

                      <p>i.e., based on robust standard errors \(\widehat{\sigma}_{\widehat{\beta}_{1}}\) gets closer to the standard normal distribution \(N\left(0, 1\right)\) (see green histogram).</p>

                      <p>Instead,</p>

                      $$
                      \begin{align}
                      z_{\overline{Y}} &= \frac{\overline{Y} - \beta}{\widetilde{\sigma}_{\widehat{\beta}_{1}}},
                      \end{align}
                      $$                      

                      <p>i.e., based on ordinary standard errors \(\widetilde{\sigma}_{\widehat{\beta}_{1}}\) does not get closer to the standard normal distribution \(N\left(0, 1\right)\) (see red histogram).</p>

                    </div>

                  </div>

                </div>
              </div>
            </div>

          </div>

      </div>
    </div>
    
    <div class="container mt-5">
      <div class="row">

          <div class="jumbotron">
            
            <p style="font-size: 18pt">More Details</p>
                    
            <button type="button" class="coll-button-cl"> <span style="font-size: 14pt;">Simulation Exercise (details)</span> </button>
            <div class="coll-content-cl">

              <ol type="1" style="margin-top: 10px;">
                <li>A realization of the DGP specificied above is simulated:
                <ol type="I">
                  <li>A i.i.d. sequence of realizations \(X_{1}, X_{2}, ..., X_{n}\) and \(u_{1}, u_{2}, ..., u_{n}\) are drawn from the distribution of \(X_{i}\) and \(u_{i}\) above.</li>
                  <li>Based on the sequence of observations \(X_{1}, X_{2}, ..., X_{n}\) and \(u_{1}, u_{2}, ..., u_{n}\) a sequence of observations \(Y_{1}, Y_{2}, ..., Y_{n}\) is constructed based on the regression model above.</li>                  
                </ol>
                </li>
                <li>Based on the sequence of observations \(Y_{1}, Y_{2}, ... Y_{n}\) and \(X_{1}, X_{2}, ..., X_{n}\), the OLS estimates and standardized OLS estimates for the intercept \(\beta_{0}\) and slope parameter \(\beta_{1}\) are calcluated.</li>  
                <li>The values of the OLS estimate \(\widehat{\beta}_{1}\) and the standardized OLS estimate \(z_{\widehat{\beta}_{1}}\) are stored.</li>
                <li>Step 1 to 3 is repeated \(10,000\) times resulting in \(10,\!000\) OLS and standardized OLS estimates.</li>
                <li>The distribution of the OLS and standardized estimates are illustrated using histograms.</li>
              </ol>

            </div>

        </div>

      </div>
    </div>
    
    <!-- .................................................. -->
    <!-- Collections of audio text -->
    <div style="display: none;">

      <!-- .................................................. -->
      <!-- default text -->
      <div id="audio-text-no-text-id" class="audio-text-cl">
        There is no explanation yet.
      </div>

      <!-- .................................................. -->
      <!-- figure 1 -->
      <div id="audio-text-figure-1-overall-id" class="audio-text-cl">
        <span>The figure shows:<br></span>
        <span>The scatter plot of the values of x and y and the corresponding fitted regression line estimated by ordinary least squares for one particular realization of the underlying data generating process.<br></span>
        <span>The red shaded area illustrates the range of all fitted regression lines estimated by ordinary least squares across all realizations for the underlying data generating process.</span>
      </div>

      <div id="audio-text-figure-1-slider-1-id" class="audio-text-cl">
        <span>Increasing the variance of u decreases the range of the different fitted regression lines estimated by ordinary least squares across different realizations of the underlying data generating process illustrated by the red shaded area.</span>
      </div>

      <div id="audio-text-figure-1-slider-2-id" class="audio-text-cl">
        <span>In the case of positive heteroskedasticity the range of the different fitted regression lines estimated by ordinary least squares across different realizations of the underlying data generating process illustrated by the red shaded area.</span>
      </div>

      <!-- .................................................. -->
      <!-- figure 2 -->
      <div id="audio-text-figure-2-overall-id" class="audio-text-cl">
        <span>The figure shows:<br></span>
        <span>The scatter plot of the value of x and the fitted residuals of a simple linear regression model estimated by ordinary least squares.<br></span>
        <span>Note, since the estimated parameters includes an intercept and a slope coefficient, the fitted residuals have a mean equal to zero and are uncorrelated with x by construction of the ordinary least squares estimator.</span>
      </div>

      <div id="audio-text-figure-2-slider-1-id" class="audio-text-cl">
        <span>Increasing the variance of the u increases the range of the fitted residuals on the x-axis as well as vertically.</span>
      </div>

      <div id="audio-text-figure-2-slider-2-id" class="audio-text-cl">
        <span>Positive heteroskedasticity leads to a wider spread of the fitted residuals for larger values of x.</span>
      </div>

      <!-- .................................................. -->
      <!-- figure 3 -->
      <div id="audio-text-figure-3-overall-id" class="audio-text-cl">
        <span>The figure shows:<br></span>
        <span>The histogram of the estimated slope coefficient across all realizations of the underlying data generating process.<br></span>
        <span>The red vertical dashed line represents the slope coefficient of the underlying data generting process.</span>
      </div>

      <div id="audio-text-figure-3-slider-1-id" class="audio-text-cl">
        <span>The figure shows:<br></span>
        <span>By increasing the variance of the u the ordinary least squares estimates get more spread around the true coefficient value.</span>
        
      </div>

      <div id="audio-text-figure-3-slider-2-id" class="audio-text-cl">
        <span>In the case of positive heteroskedasticity the ordinary least squares estimates get more spread around the true coefficient value.</span>
      </div>

      <!-- .................................................. -->
      <!-- figure 4 -->
      <div id="audio-text-figure-4-overall-id" class="audio-text-cl">
        <span>The figure shows:<br></span>
        <span>The histogram of the standardized estimated slope coefficient across all realizations of the data generating process.<br></span>
        <span>For the red histogram ordinary standard errors are used for the standardization.<br></span>
        <span>For the green histogram standard errors robust with respect to heteroskedasticity are used for the standardization.</span>
      </div>

      <div id="audio-text-figure-4-slider-1-id" class="audio-text-cl">
        <span>Increasing the variance of the u has no effect on the convergence of the standardized OLS etimates \(z_{\widehat{\beta}_{1}}\) to \(N(0,1)\).</span>
      </div>

      <div id="audio-text-figure-4-slider-2-id" class="audio-text-cl">
        <span>In the case of positive heteroskedasticity the histogram of the standardized ordinary least squares estimates based on the ordinary standard error illustrated in red no longer converges to the pdf of the standard normal distribution.<br></span>
        <span>Instead, the standardized ordinary least squares estimates based on ordinary standard errors illustrated in red are too often too high in absolute terms.<br></span>
        <span>As a consequence, the p-values of hypothesis tests about the slope coefficient based on ordinary standard errors are too small which leads to too many rejections of the null hypothesis even if it is true.<br></span>
        <span>However, the histogram of the standardized ordinary least squares estimates based on the robust standard error illustrated in green still converges to the pdf of the standard normal distribution.<br></span>
        <span>Thus, the robust standard errors are still valid for conducting hypothesis tests.</span>
      </div>

    </div>

    <!-- include/exculde ilias footer -->
    <div class="container mt-5">
      <div class="row">
        <p style="text-align: center; font-size: 20pt; font-weight: bold;" class="footer-ilias-cl">
          <a href="https://ilias.uni-hohenheim.de/data/UHOH/lm_data/lm_1781360/index_ilias.html"><em>Back to Startpage</em></a>
        </p>
      </div>
    </div>

    <!-- include/exculde github footer -->
    <div class="container mt-5">
      <div class="row">
        <p style="text-align: center; font-size: 20pt; font-weight: bold;" class="footer-github-cl">
          <a href="https://raw.githack.com/mmoessler/illustration-statistical-concepts/main/index.html"><em>Back to Startpage</em></a>
        </p>
      </div>
    </div>

    <!-- include/exculde plain back footer -->
    <div class="container mt-5">
      <div class="row">
        <p style="text-align: center; font-size: 20pt; font-weight: bold;" class="footer-plain-cl">
          <a href="javascript:void(0);" onclick="history.back();"><em>Back to Previous Page</em></a>
        </p>
      </div>
    </div>    

    <!-- footer logos -->
    <div class="container mt-5">
      <div class="row">

        <hr>
        <table style="width:100%">
          <tr>
            <td style="width: 25%; text-align: left; padding-left: 10%;">
              <img src="../assets/RZ_UniHohenheim_Logo_4C_E_blau_EN.svg" height="10%"/>
            </td>
            <td style="width: 50%; text-align: center;">
              <p style="font-size: 75%; text-align: center;">This module is part of the <a href="https://www.uni-hohenheim.de/en/project-dellfi">DeLLFi</a> project of the University of Hohenheim and funded by the <br> <a href="https://stiftung-hochschullehre.de/">Foundation for Innovation in University Teaching</a></p>
              <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
                <img alt="Creative Commons License" style="border-width:0; padding-top: -20px;" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" height="10%"/>
              </a> 
            </td>
            <td style="width: 25%; text-align: right; padding-right: 10%;">
              <img src="../assets/Logo_Stiftung_Hochschullehre.svg" height="10%"/>
            </td>
          </tr>
        </table>
        <hr>      

      </div>
    </div>

    <!-- include mathjax js via cdn -->
    <script
     src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
    </script>

    <!-- include bootstrap slider js via cdn --> 
    <script 
      src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/10.0.0/bootstrap-slider.min.js">
    </script>

    <!-- include jstat js via cdn -->
    <script
      src="https://cdn.jsdelivr.net/npm/jstat@latest/dist/jstat.min.js">
    </script>

    <!-- adjust inputs -->
    <script>

      // object with all sliders
      let sliders = {
        value: {
          slider1: [0, 0.5, 1],
          slider2: [0, 0.25, 0.5],
        },
        initialIndex: [0, 0],
        sliderValueParStr: ['\\gamma_{0}', '\\gamma_{1}'],
      };

    </script>

    <!-- include js for interaction and animation -->
    <script src="../assets/interactionAndAnimationScript.js"></script>
    
    <!-- include my javascript -->
    <script src="../assets/myScript.js"></script>  

  </body>
</html>